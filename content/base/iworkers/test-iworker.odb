
from pyre.components.Component import Component

class Worker(Component):

    class Inventory(Component.Inventory):

        import pyre.inventory
        N = pyre.inventory.int('N', default=20)
        step = pyre.inventory.float('step', default=0.2)
        

    def run(self, task):
        N = self.N; step = self.step
        
        director = self.director
        import time
        for i in range(N):
            director.declareProgress(1.*i/N, 'running...')
            time.sleep(step)
            continue
        director.declareProgress(1., 'done.')
        return


    def _configure(self):
        super(Worker, self)._configure()

        self.N = self.inventory.N
        self.step = self.inventory.step
        return
    

def iworker():
    return Worker('test-iworker', 'iworker')
